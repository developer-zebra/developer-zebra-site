<nav class="navbar  navbar-inverse" role="navigation" id="smartdocs">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-main"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
    </div>
    <div class="collapse navbar-collapse" id="navbar-collapse-main">
      <ul class="nav navbar-nav">
      <li class="navbar-right"><a id="smartdocs-help"><i class="fa fa-question-circle fa-lg fa-inverse"></i></a></li>
      <li>
        <div class="btn-group" role="group" aria-label="...">
          <button type="button" style="display:none" id="smartdocs-prev" class="btn btn-default navbar-btn"><i class="fa fa-chevron-left"></i></button>

          <button type="button" id="smartdocs-status" class="btn btn-default navbar-btn"><i class="fa fa-mobile fa-lg"></i> SmartDocs</button>
          <button type="button" style="display:none" id="smartdocs-next" class="btn btn-default navbar-btn"><i class="fa fa-chevron-right"></i></button>
        </div>
      </li>
      <li><p class="navbar-text"> Your Device:</p></li>
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" id="smartdocs-osx-selected" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">OSX: All <span class="caret"></span></a>
          <ul class="dropdown-menu">
        <li class="smartdocs-osx" data-value="" ><a>All</a></li>
        <li class="smartdocs-osx" data-value="7.1" ><a>7.1_UL</a></li>
        <li class="smartdocs-osx" data-value="8.0" ><a>8.0</a></li>
        <li class="smartdocs-osx" data-value="10.0" ><a>10.0</a></li>
          </ul>
        </li>
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" id="smartdocs-mx-selected" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">MX: All <span class="caret"></span></a>
          <ul class="dropdown-menu">
        <li class="smartdocs-mx" data-value="" ><a>All</a></li>
        <li class="smartdocs-mx" data-value="7.0" ><a>7.0</a></li>
        <li class="smartdocs-mx" data-value="8.0" ><a>8.x</a></li>
        <li class="smartdocs-mx" data-value="10.0" ><a>10.x</a></li>
          </ul>
        </li>
      <li class="dropdown">
          <a href="#" class="dropdown-toggle" id="smartdocs-api-selected" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Android: 10 <span class="caret"></span></a>
          <ul class="dropdown-menu">
        <li class="smartdocs-api" data-value="" ><a>All</a></li>
        <li class="smartdocs-api" data-value="24"><a>7.0 Nougat</a></li>
        <li class="smartdocs-api" data-value="26"><a>8.0 Oreo</a></li>
        <li class="smartdocs-api" data-value="27"><a>8.1 Oreo</a></li>
        <li class="smartdocs-api" data-value="29"><a>Android 10</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" id="smartdocs-devicetype-selected" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Model: Professional Series <span class="caret"></span></a>
          <ul class="dropdown-menu">
        <!-- <li class="smartdocs-devicetype" data-value=""><a>All Devices</a></li> -->
        <li class="smartdocs-devicetype" data-value="B"><a>Professional Series</a>
        </li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</nav>
<div class="modal fade" id="modal-smartdocs-info" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true" data-backdrop="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">X</button>
        <h4 class="modal-title">About <i class="fa fa-mobile fa-lg"></i> SmartDocs</h4>
      </div>
      <div class="modal-body">
      <p><br/><b>The "SmartDocs" bar can customize a page to show only the features present on a particular Zebra device.</b> For the Zebra TC20/TC25 feature matrix, SmartDocs parameters are pre-selected so that the matrix displays only supported features. When viewing a CSP page, the SmartDocs Nav buttons automatically scroll the page forward and back through the CSP features supported according to the parameter(s) selected in the SmartDocs bar. 
        <p>
      <b>The OSX, MX and Android API version numbers shown for each parameter indicate the <u>minimum version of support for that particular feature</u></b>; XML code generated by Zebra <a href="/stagenow"> StageNow</a> or <a href="/emdk-for-android"> EMDK</a> tools using those (or higher) versions will be effective on TC20/TC25 devices. 
      <p>
      <b>To use the SmartDocs Nav feature for TC20 or TC25 devices</b>: 
      <p>
      <ol>
        <li>Click on a CSP (i.e. "App Manager") and select the device from the Model menu.<b> <u>Unsupported features turn grey</u>. </b></li>
        <li>Click the forward and back SmartNav buttons to scroll to the next and previous supported feature</b> of that CSP (SmartNav is not supported on the feature matrix).</li>
        <li><b>To clear all selections</b> press the SmartDocs button.</li>
       </ol>
      <p><b>For other devices, selecting the OSX, MX and/or Android version(s) </b> will provide similar results. Version information for a device is found in the Android Settings panel or by querying the device through ADB, EMDK or the MX CSP.<a href="/mx/mx-version-on-device/"> More info</a>.</p>
      <ul>
        <li><b>The OSX layer</b> provides extensions to the base operating system to implement functionality not offered by Android. The root OSX version number always matches the root number of the Android version that it extends.<a href="/mx/overview/"> More info</a>.</li>
        <li><b>The MX Management System</b> provides a uniform interface into privileged and unprivileged Android APIs on the device. Some features require a specific pairing of MX and OSX versions. <a href="/mx/overview/">More info</a>.</li>
        <li><b>The Android version</b> is sometimes enough to determine a feature set. Others require a specific MX version plus a minimum version of Android.</li>
        <li><b>The Device Model</b> corresponds to a subset of MX features present in the device.</li>
      </ul>       
      </div>
  </div>
  </div>
</div>




<script type="text/javascript">

  var smartdocOptions = {
    enabled: false,
    mx: "",
    osx: "",
    api: "",
    devicetype: "",
    index: -1
  }

  var parseVersionFloat = function (versionString) {
      var versionArray = ("" + versionString)
              .replace("_", ".")
              .replace(/[^0-9.]/g, "")
              .split("."),
          sum = 0;
      for (var i = 0; i < versionArray.length; ++i) {
          sum += Number(versionArray[i]) / Math.pow(10, i * 3);
      }
      // console.log(versionString + " -> " + sum);
      return sum;
  }
  
    var showelement = function(el,filter){
      // console.log("Showing");
      // console.log(el);
      var filters=["mx","osx","api","devicetype"];
      var otherhidden = false;
      //check if something else is hidden element
      for (var i = 0; i < filters.length; i++) {
        if(typeof(el.attr('data-filter-'+filters[i])) != 'undefined' && filters[i] != filter){
          otherhidden=true;
          break;
        }
      };
      if(!otherhidden){
        // console.log("Not Showing something else has it hidden");
          el.removeClass( "not-present" );
          el.removeAttr('data-filter');
      }
        el.removeAttr('data-filter-'+filter);
    }
    var hideelement = function(el,filter){
      // console.log("Hiding");
      // console.log(el);
        el.addClass( "not-present" );
        el.attr('data-filter-'+filter,"");
        el.attr('data-filter',"");
    } 
    // SMARTDOCS VERSION SELECTOR FUNCTIONS
    var clear = function(selection){
      if(selection =='mx' || selection =='all'){
          $('[data-mx]').each(function() {
              showelement($(this),'mx');
          });

      }
      if(selection =='osx' || selection =='all'){
          $('[data-osx]').each(function() {
              showelement($(this),'osx');
          });
      }
      if(selection =='api' || selection =='all'){
          $('[data-api]').each(function() {
              showelement($(this),'api');
          });
      }
      if(selection =='devicetype' || selection =='all'){
          $('[data-devicetype]').each(function() {
              showelement($(this),'devicetype');
          });
      }
    }
    var smartdocsStatus = function(enabled){
      var filtered = $('[data-smartdoc]').not('[data-filter]');

      if(enabled & filtered.length>0){
        smartdocOptions.enabled = true;
          $("#smartdocs-status").addClass("btn-primary");
          $("#smartdocs-status").removeClass("btn-default");        
          $("#smartdocs-prev").show();
          $("#smartdocs-next").show();
              
      }
      else{
        smartdocOptions.enabled = false;
          $("#smartdocs-status").removeClass("btn-primary");
          $("#smartdocs-status").addClass("btn-default");
          $("#smartdocs-prev").hide();
          $("#smartdocs-next").hide();
      }
    }
    var showmx = function(haveVersion){
      clear('mx');
      smartdocOptions.mx = haveVersion;
        $('[data-mx]').each(function() {
            var needVersion = $(this).attr("data-mx");
            // console.log("Have")
            // console.log(parseVersionFloat(haveVersion));
            // console.log("Need")
            // console.log(parseVersionFloat(needVersion));
            if(parseVersionFloat(haveVersion)<parseVersionFloat(needVersion)){
                hideelement($(this),'mx');
            }
            else{
                // showelement($(this));
            }
            
        });
        smartdocsStatus(true);
    }

// SHOW THE SELECTED VERSION
    var showapi = function(haveVersion){
        clear('api');
      smartdocOptions.api = haveVersion;

// CALL FOR ALL HTML [SQUARE BRACKETS] ROWS WITH 'data-<something>' ATTRIBUTE
        $('[data-api]').each(function() {
            var needVersion = $(this).attr("data-api");

// CONVERT THE STRING TO A FLOAT, LOOP TO COMPARE/FORMAT EACH ROW 
            if(parseVersionFloat(haveVersion)<parseVersionFloat(needVersion)){
                hideelement($(this),'api');
            }
            else{
                // showelement($(this));
            }

        });
        smartdocsStatus(true);
    }

// SHOW THE SELECTED VERSION

    var showdevicetype = function(haveType){
        clear('devicetype');
      smartdocOptions.devicetype = haveType;

// [SQUARE BRACKETS] CALL FOR ALL HTML WITH 'data-devicetype' ATTRIBUTE
        $('[data-devicetype]').each(function() {
            var needType = $(this).attr("data-devicetype");

// HIDE EVERYTHING ELSE
            
            // IF IT MATCHES OR IS BLANK, DON'T DO ANYTHING
            if (needType.includes(haveType) || needType == "") {
            }
            // OTHERWISE HIDE OTHERS
            
            else {
            
            hideelement($(this),'devicetype');
            }

        });
        smartdocsStatus(true);
    }

    var showosx = function(haveVersion){
        clear('osx');
      smartdocOptions.osx = haveVersion;
        $('[data-osx]').each(function() {
            var needVersions = $(this).attr("data-osx").split(",");
            var versionStrict = $(this).attr("data-osx-specific");
            if(typeof(versionStrict)!='undefined' && versionStrict!=''){
                console.log('Using Strict OSX Match')
                var match=false;
                for (var i = 0; i < needVersions.length; i++) {
                    
                    if(parseVersionFloat(needVersions[i]) == parseVersionFloat(haveVersion)){
                        match=true;
                        
                    }
                    else{
                        match=false;
                    }
                };

                if(match){
                    // $( this ).fadeTo( "slow", 0.40 )
                    hideelement($(this),'osx');
                }
                else{
                    // showelement($(this));
                }

            }
            else{
                var okinlist=false;
                for (var i = 0; i < needVersions.length; i++) {
          // console.log("Have")
       //          console.log(parseVersionFloat(haveVersion));
       //          console.log("Need")
       //          console.log(parseVersionFloat(needVersions[i]));                 
                    if( parseVersionFloat(haveVersion) >= parseVersionFloat(needVersions[i])){
                        okinlist=true;
                        break;
                    }
                };
                if(!okinlist){
                  console.log("Hiding: " + match)
                    hideelement($(this),'osx');
                }
                else{
                    // showelement($(this));
                }

            }
            
        });
        smartdocsStatus(true);

    }

    var gotoNextAvailable = function() {
      var filtered = $('[data-smartdoc]').not('[data-filter]');

      if(filtered.length>0 ){
        var max_index = filtered.length-1;
        
        smartdocOptions.index  = smartdocOptions.index  + 1;
        if(smartdocOptions.index >max_index){
          smartdocOptions.index  = 0; //loop
        }
        var target = $(filtered[smartdocOptions.index ]);
        $('html, body').animate({
              scrollTop: target.offset().top - 220
          }, 1000);
          

      }

    }
    var gotoPrevAvailable = function() {
      var filtered = $('[data-smartdoc]').not('[data-filter]');
      if(filtered.length>0 ){
        var max_index = filtered.length-1;
        
        smartdocOptions.index  = smartdocOptions.index  - 1;
        if(smartdocOptions.index == -1){
          smartdocOptions.index  = max_index; //loop
        }
        var target = $(filtered[smartdocOptions.index ]);
        $('html, body').animate({
              scrollTop: target.offset().top - 220
          }, 1000);

      }
    }
    

/*  PERFORM THE FOLLOWING AFTER THE 
    DOCUMENT HAS BEEN LOADED AND IS 
    READY FOR USER INTERACTION */
    
    $(document).ready(function() {

    $( "#smartdocs-help" ).click(function() {
        console.log('Show SmartDocs help');
        $("#modal-smartdocs-info").modal({show: true});
        
    });
    $(window).bind('scroll', function() {

      var navHeight = 200; // custom nav height
      ($(window).scrollTop() > navHeight) ? $('#smartdocs').addClass('goToTop') : $('nav').removeClass('goToTop');

    });

    //for pages that have fixed content
    $(".fixed-column-right").bind('scroll', function() {

      var navHeight = 200; // custom nav height
      ($(".fixed-column-right").scrollTop() > navHeight) ? $('#smartdocs').addClass('goToTop') : $('nav').removeClass('goToTop');

    });

    $( "#smartdocs-status" ).click(function() {
        console.log('Change Status');
        console.log(smartdocOptions);
        
        if(smartdocOptions.enabled){
          //clear settings
          smartdocsStatus(!smartdocOptions.enabled);
          smartdocOptions = {
          enabled: true,
          mx: "",
          osx: "",
          api: "",
          devicetype: ""
        };
          $("#smartdocs-mx-selected").html("MX: All" + '<span class="caret"></span>');
          $("#smartdocs-osx-selected").html("OSX: All" + '<span class="caret"></span>');
          $("#smartdocs-api-selected").html("Android: All" + '<span class="caret"></span>');
          $("#smartdocs-devicetype-selected").html("Model: All" + '<span class="caret"></span>');
          clear('all');       
          
        }

    });
    $( "#smartdocs-next" ).click(function() {
      gotoNextAvailable();
    });
    $( "#smartdocs-prev" ).click(function() {
      gotoPrevAvailable();
    });
    $( ".smartdocs-mx" ).click(function() {
      var mx=$(this).attr("data-value");

        console.log('Setting mx');
        $("#smartdocs-mx-selected").html("MX: " + $(this).text() + '<span class="caret"></span>');
        if(mx ==""){
          clear('mx')
        }
        else{
          showmx(mx);
        }
    });

// GET THE VERSION (data-value) FOR THE CLICKED SELECTION (var = osx, etc.)
    $( ".smartdocs-osx" ).click(function() {
      var osx=$(this).attr("data-value");
        $("#smartdocs-osx-selected").html("OSX: " + $(this).text() + '<span class="caret"></span>');

//REPORT ACTIVITY IN THE JAVASCRIPT CONSOLE 
         console.log('Setting osx');

//DISPLAY SELECTED VERSION IN THE SMARTDOCS NAVBAR 
        if(osx ==""){
          clear('osx')
        }
        else{
          showosx(osx);
        }
    });
    $( ".smartdocs-api" ).click(function() {
      var api=$(this).attr("data-value");
        $("#smartdocs-api-selected").html("Android: " + $(this).text() + '<span class="caret"></span>');
        console.log('Setting api');
        if(api ==""){
          clear('api')
        }
        else{
          showapi(api);
        }
    });

// NEED TO CHANGE OTHER SETTINGS TO 'ALL' BELOW

    $( ".smartdocs-devicetype" ).click(function() {
      var devicetype=$(this).attr("data-value");
        $("#smartdocs-devicetype-selected").html("Model: " + $(this).text() + '<span class="caret"></span>');
        console.log('Setting device type');
        if(devicetype ==""){
          clear('devicetype')
        }
        else{
          clear("api");
          clear("mx");
          clear("osx");
          showdevicetype(devicetype);
        }
    }); 

    // Pre-select a SmartDocs parameter (0, 1, 2...) 
    // MUST BE THE LAST SCRIPT FUNCTION
   $(".smartdocs-devicetype")[0].click();
    //REPORT THE ACTIVITY IN THE JAVASCRIPT CONSOLE 
        console.log('pre-selecting devicetype before the final });');
    });
</script>